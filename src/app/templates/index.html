<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>easeML</title>
    <link rel="stylesheet" href="../static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../static/script.js" defer ></script>
    <script src="../static/history_script.js" defer ></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="left">
            <a href="/" class="easeML">easeML</a>
            <ul>
                <li class="playground-button"><a href="/playground">Playground<span class="new-tag">New!</span></a></li>
            </ul>
        </div>
        <div class="right">
            <div class="hamburger-menu">
                <span>&#9776;</span> <!-- Represents the hamburger icon -->
            </div>
        </div>
        
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Parameter Options -->
        <div class="parameter-options">
            <h3>Model Configuration</h3>

            <!-- Loss Function Selection -->
            <div class="slider-container">
                <div class="slider-header">
                    <label for="loss_function">Loss Function:</label>
                    <button class="info-button" onclick="toggleInfo('loss_function_info', this)">▼</button>
                </div>
                <select id="loss_function" onchange="updateSpecificLossFunctionInfo()">
                    <option value="cross_entropy">Cross Entropy</option>
                    <option value="nll_loss">Negative Log Likelihood</option>
                    <!-- Add other loss functions as needed -->
                </select>
            </div>

            <!-- Specific Infobox for Chosen Loss Function -->
            <div id="loss_function_info" class="info-panel" style="display: none;">
                <p>Loss functions measure how well the model performs. Different functions are suitable for different types of tasks.</p>
                <p id="specific_loss_function_description">Select a loss function to see more details here.</p>
            </div>


            <!-- Other parameters -->
            <div class="slider-container">
                <div class="slider-header">
                    <label for="batch_size_slider">Batch Size:</label>
                    <!-- Fold-out button with initial arrow symbol -->
                    <button class="info-button" onclick="toggleInfo('batch_size_info', this)">▼</button>
                </div>
                <!-- Hidden information panel -->
                <div id="batch_size_info" class="info-panel">
                    <p>Batch size determines the number of samples processed before the model is updated.</p>
                </div>
                <input type="range" id="batch_size_slider" name="batch_size" min="1" max="512" value="256">
                <span id="batch_size_value">256</span>
            </div>
            <div class="slider-container">
                <div class="slider-header">
                    <label for="learning_rate_slider">Learning Rate:</label>
                    <!-- Fold-out button with initial arrow symbol -->
                    <button class="info-button" onclick="toggleInfo('learning_rate', this)">▼</button>
                </div>
                <!-- Hidden information panel -->
                <div id="learning_rate" class="info-panel">
                    <p>The speed at which a model learns; a higher rate can hasten learning but risk overshooting optimal solutions.</p>
                </div>
                <input type="range" id="learning_rate_slider" name="learning_rate" min="0.01" max="1" step="0.01" value="0.3">
                <span id="learning_rate_value">0.3</span>
            </div>
            <div class="slider-container">
                <div class="slider-header">
                    <label for="momentum_slider">Momentum:</label>
                    <!-- Fold-out button with initial arrow symbol -->
                    <button class="info-button" onclick="toggleInfo('momentum_slider_info', this)">▼</button>
                </div>
                <!-- Hidden information panel -->
                <div id="momentum_slider_info" class="info-panel">
                    <p>A technique to accelerate the model's learning, particularly helpful in navigating ravines and avoiding local minima.</p>
                </div>
                <input type="range" id="momentum_slider" name="momentum" min="0" max="1" step="0.01" value="0.5">
                <span id="momentum_value">0.5</span>
            </div>
            <button id="update_params_btn">Update Parameters</button>
        </div>

        <div id="training-control">
            <div class="control-and-animation">
                <h3>Training Control</h3>
                <!-- Control Buttons -->
                <div class="control-buttons">
                    <button id="start_training">Start Training</button>
                    <button id="stop_training">Stop</button>
                    <button id="continue_training">Continue</button>
                </div>

                <!-- Neural Network Animation -->
                <div id="neuralNetworkAnimation" class="neural-network" style="display: none;">
                    <!-- Layer 1 -->
                    <div class="node-row">
                        <div class="node"></div>
                        <div class="node"></div>
                        <!-- Add more nodes as needed -->
                    </div>
                    <!-- Repeat for additional layers (2-5) with different numbers of nodes -->
                    <!-- Layer 2 -->
                    <div class="node-row">
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <!-- Add more nodes as needed -->
                    </div>
                    <!-- Layer 3 -->
                    <div class="node-row">
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <!-- Add more nodes as needed -->
                    </div>
                    <!-- Layer 4 -->
                    <div class="node-row">
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <div class="node"></div>
                        <!-- Add more nodes as needed -->
                    </div>
                    <!-- ... additional layers ... -->
                    <!-- Layer 5 -->
                    <div class="node-row">
                        <div class="node"></div>
                        <div class="node"></div>
                        <!-- Add more nodes as needed -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Configuration area / Additional area -->
        <div class="additional-buttons">
            <div class="history-selector">
                <button id="select_config_btn">Configuration</button>
                <button id="select_model_btn">Model</button>
            </div>
            <div id="configuration-history">
                <h3>Configuration History</h3>
                <!-- Configuration List Box -->
                <div id="configurationList" class="config-list">
                    <p>No configurations saved yet.</p>
                </div>

                <button id="save_config">Save Configuration</button>
                <button id="remove_config">Remove Config</button>
                <button id="load_config">Load Config</button>
                <br>
                <button id="clear_config_history">Clear Configuration History</button>
            </div>
            <div hidden id="model-history">
                <h3>Model History</h3>
                <!-- Configuration List Box -->
                <div id="modelList" class="model-list">
                    <p>No models saved yet.</p>
                </div>

                <button id="save_model">Save Model</button>
                <button id="remove_model">Remove Model</button>
                <button id="download_model">Download Model</button>
                <br>
                <button id="clear_model_history">Clear Model History</button>        
            </div>
        </div>
    </div>

    <!-- Training Monitor / Analysis -->
    <div class="training-monitor">
        <div class="monitor-container">
        <h3>Training Monitor</h3>
          <!-- Charts -->
          <div class="chart-section-container">
            <!-- Loss Chart -->
            <div class="chart-container">
                <div class="chart-header">
                    <label>Loss:</label>
                    <button class="info-button" onclick="toggleInfo('loss_info', this)">▼</button>
                </div>
                <div id="loss_info" class="info-panel">
                    <p>Measurement of how far the model's predictions deviate from the actual values, guiding optimization.</p>
                </div>
                <div class="chart-content">
                    <canvas id="lossChart"></canvas>
                </div>
            </div>
        
            <!-- Accuracy Chart -->
            <div class="chart-container">
                <div class="chart-header">
                    <label>Accuracy:</label>
                    <button class="info-button" onclick="toggleInfo('accuracy_info', this)">▼</button>
                </div>
                <div id="accuracy_info" class="info-panel">
                    <p>Proportion of correct predictions made by the model, indicating its overall effectiveness.</p>
                </div>
                <div class="chart-content">
                    <canvas id="accuracyChart"></canvas>
                </div>
            </div>
        </div>
        </div>
        <!-- Current Parameters Section -->
        <div class="current-parameters-section">
            <h3>Current Parameters</h3>
            <p> </p>
            <p>Accuracy: <span id="accuracy">N/A</span></p>
            <p>Loss Function: <span id="current_loss_function">N/A</span></p>
            <p>Batch Size: <span id="current_batch_size">N/A</span></p>
            <p>Learning Rate: <span id="current_learning_rate">N/A</span></p>
            <p>Momentum: <span id="current_momentum">N/A</span></p>
        </div>
    </div>

    <script>
        window.onload = function() {
            const neuralNetworkAnimation = document.getElementById('neuralNetworkAnimation');

            neuralNetworkAnimation.style.display = 'flex';

            let newParams = {
            "optimizer_params": {
                "type": "SGD",
                "args": {
                "lr": 0.3,
                "momentum": 0.5
                }
            },
            "batch_size": 256,
            "loss_function": "cross_entropy"
            };
            updateTrainingParams(newParams); // Initialize parameter config
            updateSpecificLossFunctionInfo();
        };
    </script>
</body>
</html>
